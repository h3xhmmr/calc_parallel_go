# Веб-сервис для решения простейших арифметических выражений

## Принцип работы
Веб-сервис состоит из двух микросервисов:
* Оркестратор, принимающий от пользователя выражение, делящий его на подзадачи вида "a+b", отправляющий их агенту, после чего он собирает ответы в новое выражение, пока не придет к окончательному ответу
* Агент, запускающий горутины для вычисления подзадач, отправляемых оркестратором

Агент и оркестратор коннектятся через http соединение. Агент отправляет запросы на задачу оркестратору через метод Get, а результаты через метод Post

## Вводимые данные


Сервер принимает запрос по url-ом `localhost/api/v1/calculate` и телом  `{
    "expression": "выражение, которое ввёл пользователь"
}`


Сервер поддерживает следующие арифметические операции с числами (именно числами, т.е. имеющими более 1 цифры в записи):  
* умножение
* деление
* сложение
* вычитание


А также учитывает приоритетные знаки (в том числе и скобки)


Наличие и количество пробелов в вводимом выражении неважно


## Ошибки


Сервер будет выдавать ошибки в следующих случаях:  
* Введенное выражение имеет незакрытые скобки или несколько операторов, стоящих подряд ("invalid expression")
* В результате вычислений будет происходить деление на ноль ("division by zero")
* Введенное выражение имеет символы кроме символов операторов `()+-.*` и цифр `1234567890` ("invalid expression")
* Была введена пустая строка ("invalid body")
* При попытке отправить запрос не POST методом ("wrong method")


## Запуск проекта

Для начала установите Go на свой компьютер [install golang](https://go.dev/doc/install) и VisualStudio [install VS](https://code.visualstudio.com/)

Далее, зайдя в VStudio необходимо клонировать репозиторий `git clone https://github.com/h3xhmmr/calc_go`, а затем запустить сервер (по умолчанию работает на порте :8080) `go run calc_go/cmd/main.go`


## Примеры использования

### Отправление выражения
Запрос:


curl --location 'localhost/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "2+2"
}'


Ответ:


{
    "id": "101dfa8a-85ea-4e40-b3f0-4c0558cf527b"
}


### Получение списка выражений 
Запрос:


curl --location 'localhost/api/v1/expressions'


Ответ:


{
    "expressions": [
        {
            "id": "101dfa8a-85ea-4e40-b3f0-4c0558cf527b",
            "status": "in process",
            "result": "2+3*6"
        },
        {
            "id": "703dfa8a-97ea-4e40-b3f0-4c0788cf527b",
            "status": "done",
            "result": "5.0"
        }
    ]
}


### Получение выражения по id 
Запрос:


curl --location 'localhost/api/v1/expressions/:461b38f9-2779-4be5-85b4-180ec362e4c0'


Ответ:


{
    "expression":
        {
            "id": "461b38f9-2779-4be5-85b4-180ec362e4c0",
            "status": "in process",
            "result": "2-7"
        }
}


Также возможен (желательно, т.к. curl немного сломан) запуск через Postman  
Для этого в строке адреса выберите метод Post и введите адрес `http://localhost:8080/api/v1/calculate`, после чего в поле body введите свой запрос в формате `{"expression": "2+2*2"}`


Примеры использования через Postman находятся в папке example_postman